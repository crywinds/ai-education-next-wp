@echo off
chcp 65001 >nul
title [AI??-??] Next.js WordPress ?? - Port 5200
color 0A
echo.
echo ========================================
echo    AI ???? - Next.js WordPress ????
echo    ????: f:\FIFA\new-next-wp
echo    ????: http://localhost:5200
echo ========================================
echo.

REM ?? MySQL ????
if exist "C:\xampp\mysql\bin\mysqld.exe" (
    echo [AI??-??] ??? XAMPP MySQL
    REM ?? MySQL ????????3306???
    netstat -an | findstr ":3306" | findstr "LISTENING" >nul 2>&1
    if %errorlevel% neq 0 (
        echo [AI??-??] [??] MySQL ?????????? 3306 ????
        echo [AI??-??] [??] ???? XAMPP Control Panel ??? MySQL ??
        echo [AI??-??] [??] ??: C:\xampp\xampp-control.exe
        echo.
        set /p open_xampp="?????? XAMPP Control Panel? (Y/N): "
        if /i "%open_xampp%"=="Y" (
            start "" "C:\xampp\xampp-control.exe"
            echo [AI??-??] [??] ?? XAMPP Control Panel ??? MySQL?????????...
            pause >nul
        )
    ) else (
        echo [AI??-??] [??] MySQL ????????? 3306 ?????
    )
    echo.
) else if exist "C:\xampp\xampp-control.exe" (
    echo [AI??-??] [??] ??? XAMPP
    echo [AI??-??] [??] ????? XAMPP Control Panel ??? MySQL
    echo.
)

REM ?? Node.js ????
where node >nul 2>&1
if %errorlevel% neq 0 (
    echo [AI??-??] [??] ???? Node.js????? Node.js
    echo [AI??-??] ????: https://nodejs.org/
    pause
    exit /b 1
)

echo [AI??-??] [??] ??? Node.js ??:
node --version
echo.

REM ?????????
if not exist "node_modules" (
    echo [AI??-??] [??] ?????????????...
    echo.
    call npm install
    if %errorlevel% neq 0 (
        echo [AI??-??] [??] ??????
        pause
        exit /b 1
    )
    echo.
    echo [AI??-??] [??] ??????
    echo.
) else (
    echo [AI??-??] [??] ????????????
    echo.
)

REM ???????
color 0A
echo.
echo ========================================
echo           ???????
echo ========================================
echo.
echo [AI??-??] ???? Next.js ?????...
echo [AI??-??] ?????: http://localhost:5200
echo [AI??-??] ? Ctrl+C ??????
echo.
echo ========================================
echo.

call npm run dev

pause
